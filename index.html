<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pro M3U8 Recorder</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  background:#0b0b0b;
  color:#fff;
  font-family:Arial,Helvetica,sans-serif;
}
.header{
  padding:12px;
  background:#111;
  text-align:center;
  font-weight:bold;
  letter-spacing:1px;
}
.container{
  padding:10px;
}
input{
  width:100%;
  padding:12px;
  border-radius:6px;
  border:none;
  outline:none;
  font-size:14px;
}
button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border:none;
  border-radius:6px;
  font-size:15px;
  background:#ff2d55;
  color:#fff;
  cursor:pointer;
}
.video-box{
  position:relative;
  margin-top:12px;
}
video{
  width:100%;
  background:#000;
  border-radius:8px;
}
.record-btn{
  position:absolute;
  bottom:15px;
  right:15px;
  background:red;
  width:55px;
  height:55px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
  font-weight:bold;
}
.recording{
  animation:pulse 1s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 0 0 rgba(255,0,0,.7);}
  70%{box-shadow:0 0 0 15px rgba(255,0,0,0);}
  100%{box-shadow:0 0 0 0 rgba(255,0,0,0);}
}
</style>
</head>

<body>

<div class="header">PRO M3U8 RECORDER</div>

<div class="container">
  <input id="url" placeholder="Paste m3u8 link here">
  <button onclick="loadStream()">â–¶ PLAY STREAM</button>

  <div class="video-box">
    <video id="video" controls playsinline></video>
    <div class="record-btn" id="recBtn" onclick="toggleRec()">REC</div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
let video = document.getElementById("video");
let recBtn = document.getElementById("recBtn");
let recorder, chunks=[];
let recording=false;

function loadStream(){
  let m3u8 = document.getElementById("url").value;
  if(Hls.isSupported()){
    let hls = new Hls();
    hls.loadSource(m3u8);
    hls.attachMedia(video);
  }else{
    video.src = m3u8;
  }
  video.play();
}

function toggleRec(){
  if(!recording){
    startRec();
  }else{
    stopRec();
  }
}

function startRec(){
  chunks=[];
  let stream = video.captureStream();
  recorder = new MediaRecorder(stream,{mimeType:"video/webm"});
  recorder.ondataavailable=e=>chunks.push(e.data);
  recorder.start();
  recording=true;
  recBtn.classList.add("recording");
  recBtn.innerText="STOP";
}

function stopRec(){
  recorder.stop();
  recorder.onstop=()=>{
    let blob=new Blob(chunks,{type:"video/webm"});
    let url=URL.createObjectURL(blob);
    let a=document.createElement("a");
    a.href=url;
    a.download="recorded_stream.webm";
    a.click();
  };
  recording=false;
  recBtn.classList.remove("recording");
  recBtn.innerText="REC";
}
</script>

</body>
</html>
